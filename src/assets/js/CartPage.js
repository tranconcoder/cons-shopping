(()=>{"use strict";const t=(t,n=document)=>n.querySelector(t);class n{static getCartList(){return JSON.parse(localStorage.getItem(this.CART_STORAGE_KEY)||"[]")}static addCart(t){const n=this.getCartList();n.push(t),localStorage.setItem(this.CART_STORAGE_KEY,JSON.stringify(n))}}n.CART_STORAGE_KEY="cons_shopping_cart";const s=n,i=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"});new class{constructor(){this.productIdList=[],this.productList=[],this.cartListCtn=document.createElement("ul"),this.cartItemList=[],this.initData()}initData(){return t=this,n=void 0,e=function*(){this.productIdList=s.getCartList();const t=[...new Set(this.productIdList)],n=yield Promise.all(t.map((t=>fetch(`/api/get-product?productId=${t}`))));this.productList=yield Promise.all(n.map((t=>t.json()))),this.initElm(),this.initView(),this.initEvent()},new((i=void 0)||(i=Promise))((function(s,a){function c(t){try{o(e.next(t))}catch(t){a(t)}}function r(t){try{o(e.throw(t))}catch(t){a(t)}}function o(t){var n;t.done?s(t.value):(n=t.value,n instanceof i?n:new i((function(t){t(n)}))).then(c,r)}o((e=e.apply(t,n||[])).next())}));var t,n,i,e}initElm(){this.cartListCtn=t(".cart-list-wrapper .cart-list")}initView(){this.cartItemList=this.productList.map((t=>{const n=document.createElement("li");return n.classList.add("cart-item"),n.innerHTML=`\n                <input type="checkbox">\n\n                <img src="${t.thumb}" alt="" class="thumb">\n\n                <span class="name">${t.label}</span>\n\n                <span class="count">\n                    <button class="sub">-</button>\n                    <input type="number" min="1" id="" value="1">\n                    <button class="add">+</button>\n                </span>\n\n                <span class="price">${i.format(t.cost)}</span>\n\n                <span class="cost">${i.format(t.cost)}Ä‘</span>\n            `,n})),this.cartItemList.forEach((t=>this.cartListCtn.appendChild(t)))}initEvent(){this.cartItemList.forEach(((n,s)=>{const e=t(".sub",n),a=t(".add",n),c=t("input[type=number]",n),r=t(".cost",n),o=()=>{const t=+c.value*this.productList[s].cost;r.textContent=i.format(t)};a.addEventListener("click",(()=>{c.value=+c.value+1+"",o()})),e.addEventListener("click",(()=>{c.value="1"!=c.value?+c.value-1+"":"1",o()})),c.addEventListener("input",(()=>{+c.value<1&&(c.value="1")})),c.addEventListener("change",o)}))}}})();