(()=>{"use strict";var e,t={858:(e,t,n)=>{n.d(t,{$:()=>a,$$:()=>i});const a=(e,t=document)=>t.querySelector(e),i=(e,t=document)=>t.querySelectorAll(e)}},n={};function a(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=a(858),(new class{constructor(){this.changeInfoPreviousValue="",this.updateImageBoxStateInput=(0,e.$)("#update-image-box-state"),this.inputFileImageList=(0,e.$$)(".home-image-slide tbody .thumb input"),this.updateImagePreviewImg=(0,e.$)("#preview-img"),this.updateImageBoxAcceptButton=(0,e.$)(".update-image-box .button-list .accept"),this.removeImageButtonList=(0,e.$$)(".home-image-slide tbody tr .action > button"),this.imageInfoInputList=(0,e.$$)('.home-image-slide tbody tr td input[type="text"] , .home-image-slide tbody tr td input[type="number"]')}listenEvent(){this.inputFileImageList.forEach((e=>{e.addEventListener("change",this.handleChangeFileInput.bind(this))})),this.removeImageButtonList.forEach((e=>{e.addEventListener("click",this.removeImageSlide.bind(this))})),this.updateImageBoxAcceptButton.addEventListener("click",(t=>{var n,a;const i=(0,e.$)(`input[data-id="${this.updateImagePreviewImg.dataset.id}"]`);(null===(n=i.files)||void 0===n?void 0:n.length)&&(null===(a=this.updateImagePreviewImg.dataset.id)||void 0===a?void 0:a.length)&&this.submitNewImage(null==i?void 0:i.files[0],i.dataset.id)})),this.imageInfoInputList.forEach((e=>{e.addEventListener("focusin",(e=>{this.changeInfoPreviousValue=e.target.value}))})),this.imageInfoInputList.forEach((e=>{e.addEventListener("change",this.changeImageInfo.bind(this))}))}handleChangeFileInput(e){const t=e.target.files[0],n=URL.createObjectURL(t),a=e.target.previousElementSibling;this.updateImageBoxStateInput.checked=!0,this.updateImagePreviewImg.src=n,this.updateImagePreviewImg.dataset.id=e.target.dataset.id,a.src=n}submitNewImage(e,t){const n=new FormData;n.append("id",t),n.append("file",e),fetch("/api/change-image-slider",{method:"POST",body:n}).then((e=>e.json())).then((e=>{!0===e&&(alert("Success!"),this.updateImageBoxStateInput.checked=!1)})).catch((e=>console.log(e)))}removeImageSlide(e){if(!confirm("Bạn có muốn xóa ảnh này không?"))return;const t=e.target.dataset.id,n=new FormData;n.append("imageId",t),fetch("/api/remove-image-slider",{method:"POST",body:n}).then((e=>e.json())).then((t=>{!t.error&&t&&e.target.parentElement.parentElement.remove()}))}changeImageInfo(e){const t=e.target,n=(t.name,t.value);let a=t;for(;!(a instanceof HTMLTableRowElement);)a=a.parentNode;const i=a.dataset.id,o=new FormData;o.append("imageId",i),o.append("field",t.name),o.append("newValue",n.toString()),fetch("/api/update-info-image-slider",{method:"POST",body:o}).then((e=>e.json())).then((e=>{"Error: Order is used"==e.message&&(confirm("STT mới đã được sử dụng, bạn có muốn hoán đổi vị trí 2 ảnh này không?")?this.handleSwapOrderImage(n,this.changeInfoPreviousValue):t.value=this.changeInfoPreviousValue)})).catch((e=>console.error("Error: ",e)))}handleSwapOrderImage(e,t){const n=new FormData;n.append("order1",e.toString()),n.append("order2",t.toString()),fetch("/api/swap-order-image-slider",{method:"POST",body:n}).then((e=>e.json())).then((e=>{e.error||window.location.reload()})).catch((e=>console.log(e)))}}).listenEvent(),(new class{constructor(){this.addNewImageForm=(0,e.$)(".home-image-slide form.add-new-image"),this.imageNameInput=(0,e.$)('input[type="text"]',this.addNewImageForm),this.imageFileInput=(0,e.$)('input[type="file"]',this.addNewImageForm),this.submitNewImageButton=(0,e.$)("button.submit",this.addNewImageForm)}listenEvent(){this.imageNameInput.addEventListener("focusout",(t=>{var n;const a=t.target,i=null===(n=a.parentElement)||void 0===n?void 0:n.parentElement,o=(0,e.$)(".error-message",i);a.value.length?i.classList.remove("error"):(i.classList.add("error"),o.textContent="Vui lòng nhập tên hình ảnh!")})),this.addNewImageForm.addEventListener("submit",(t=>{var n;t.preventDefault();const a=t.target,i=null===(n=this.imageNameInput.parentElement)||void 0===n?void 0:n.parentElement,o=(0,e.$)(".error-message",i);this.imageNameInput.value.length?a.submit():(i.classList.add("error"),o.textContent="Vui lòng nhập tên hình ảnh!")}))}}).listenEvent(),(new class{constructor(){this.productListItem=(0,e.$$)(".product-list-container .product-item")}listenEvent(){this.productListItem.forEach((t=>{(0,e.$)("button.delete",t).addEventListener("click",(e=>{const n=t.dataset.id,a=new FormData;a.append("productId",n),fetch("/api/remove-product",{method:"POST",body:a}).then((e=>e.json())).then((e=>{e.error||t.remove()})).catch((e=>console.log(e)))}))}))}}).listenEvent()})();