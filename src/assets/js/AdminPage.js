(()=>{"use strict";var e,t={858:(e,t,a)=>{a.d(t,{$:()=>n,$$:()=>i});const n=(e,t=document)=>t.querySelector(e),i=(e,t=document)=>t.querySelectorAll(e)}},a={};function n(e){var i=a[e];if(void 0!==i)return i.exports;var o=a[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=n(858),(new class{constructor(){this.changeInfoPreviousValue="",this.updateImageBoxStateInput=(0,e.$)("#update-image-box-state"),this.inputFileImageList=(0,e.$$)(".home-image-slide tbody .thumb input"),this.updateImagePreviewImg=(0,e.$)("#preview-img"),this.updateImageBoxAcceptButton=(0,e.$)(".update-image-box .button-list .accept"),this.removeImageButtonList=(0,e.$$)(".home-image-slide tbody tr .action > button"),this.imageInfoInputList=(0,e.$$)('.home-image-slide tbody tr td input[type="text"] , .home-image-slide tbody tr td input[type="number"]')}listenEvent(){this.inputFileImageList.forEach((e=>{e.addEventListener("change",this.handleChangeFileInput.bind(this))})),this.removeImageButtonList.forEach((e=>{e.addEventListener("click",this.removeImageSlide.bind(this))})),this.updateImageBoxAcceptButton.addEventListener("click",(t=>{var a,n;const i=(0,e.$)(`input[data-id="${this.updateImagePreviewImg.dataset.id}"]`);(null===(a=i.files)||void 0===a?void 0:a.length)&&(null===(n=this.updateImagePreviewImg.dataset.id)||void 0===n?void 0:n.length)&&this.submitNewImage(null==i?void 0:i.files[0],i.dataset.id)})),this.imageInfoInputList.forEach((e=>{e.addEventListener("focusin",(e=>{this.changeInfoPreviousValue=e.target.value}))})),this.imageInfoInputList.forEach((e=>{e.addEventListener("change",this.changeImageInfo.bind(this))}))}handleChangeFileInput(e){const t=e.target.files[0],a=URL.createObjectURL(t),n=e.target.previousElementSibling;this.updateImageBoxStateInput.checked=!0,this.updateImagePreviewImg.src=a,this.updateImagePreviewImg.dataset.id=e.target.dataset.id,n.src=a}submitNewImage(e,t){const a=new FormData;a.append("id",t),a.append("file",e),fetch("/api/change-image-slider",{method:"POST",body:a}).then((e=>e.json())).then((e=>{!0===e&&(alert("Success!"),this.updateImageBoxStateInput.checked=!1)})).catch((e=>console.log(e)))}removeImageSlide(e){if(!confirm("Bạn có muốn xóa ảnh này không?"))return;const t=e.target.dataset.id,a=new FormData;a.append("imageId",t),fetch("/api/remove-image-slider",{method:"POST",body:a}).then((e=>e.json())).then((t=>{!t.error&&t&&e.target.parentElement.parentElement.remove()}))}changeImageInfo(e){const t=e.target,a=(t.name,t.value);let n=t;for(;!(n instanceof HTMLTableRowElement);)n=n.parentNode;const i=n.dataset.id,o=new FormData;o.append("imageId",i),o.append("field",t.name),o.append("newValue",a.toString()),fetch("/api/update-info-image-slider",{method:"POST",body:o}).then((e=>e.json())).then((e=>{"Error: Order is used"==e.message&&(confirm("STT mới đã được sử dụng, bạn có muốn hoán đổi vị trí 2 ảnh này không?")?this.handleSwapOrderImage(a,this.changeInfoPreviousValue):t.value=this.changeInfoPreviousValue)})).catch((e=>console.error("Error: ",e)))}handleSwapOrderImage(e,t){const a=new FormData;a.append("order1",e.toString()),a.append("order2",t.toString()),fetch("/api/swap-order-image-slider",{method:"POST",body:a}).then((e=>e.json())).then((e=>{e.error||window.location.reload()})).catch((e=>console.log(e)))}}).listenEvent(),(new class{constructor(){this.addNewImageForm=(0,e.$)(".home-image-slide form.add-new-image"),this.imageNameInput=(0,e.$)('input[type="text"]',this.addNewImageForm),this.imageFileInput=(0,e.$)('input[type="file"]',this.addNewImageForm),this.submitNewImageButton=(0,e.$)("button.submit",this.addNewImageForm)}listenEvent(){this.imageNameInput.addEventListener("focusout",(t=>{var a;const n=t.target,i=null===(a=n.parentElement)||void 0===a?void 0:a.parentElement,o=(0,e.$)(".error-message",i);n.value.length?i.classList.remove("error"):(i.classList.add("error"),o.textContent="Vui lòng nhập tên hình ảnh!")})),this.addNewImageForm.addEventListener("submit",(t=>{var a;t.preventDefault();const n=t.target,i=null===(a=this.imageNameInput.parentElement)||void 0===a?void 0:a.parentElement,o=(0,e.$)(".error-message",i);this.imageNameInput.value.length?n.submit():(i.classList.add("error"),o.textContent="Vui lòng nhập tên hình ảnh!")}))}}).listenEvent()})();